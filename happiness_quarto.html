<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.32">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>happiness_quarto</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="happiness_quarto_files/libs/clipboard/clipboard.min.js"></script>
<script src="happiness_quarto_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="happiness_quarto_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="happiness_quarto_files/libs/quarto-html/popper.min.js"></script>
<script src="happiness_quarto_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="happiness_quarto_files/libs/quarto-html/anchor.min.js"></script>
<link href="happiness_quarto_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="happiness_quarto_files/libs/quarto-html/quarto-syntax-highlighting-37eea08aefeeee20ff55810ff984fec1.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="happiness_quarto_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="happiness_quarto_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="happiness_quarto_files/libs/bootstrap/bootstrap-81267100e462c21b3d6c0d5bf76a3417.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">happiness_quarto</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="libraries" class="level3">
<h3 class="anchored" data-anchor-id="libraries">Libraries</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   4.0.0     ✔ tibble    3.3.0
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.1.0     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'

The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(descr)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dbplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dbplyr'

The following objects are masked from 'package:dplyr':

    ident, sql</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice
Loading required package: plyr
------------------------------------------------------------------------------
You have loaded plyr after dplyr - this is likely to cause problems.
If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
library(plyr); library(dplyr)
------------------------------------------------------------------------------

Attaching package: 'plyr'

The following object is masked from 'package:ggpubr':

    mutate

The following objects are masked from 'package:dplyr':

    arrange, count, desc, failwith, id, mutate, rename, summarise,
    summarize

The following object is masked from 'package:purrr':

    compact</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level3">
<h3 class="anchored" data-anchor-id="import-data">Import Data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>happiness <span class="ot">&lt;-</span><span class="fu">read.csv2</span>(<span class="st">"felicidadcis.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Description:</p>
<p>Happiness: Numeric variable ranging from 0 to 10, representing the respondent’s level of happiness.</p>
<p>Income: Categorical variable representing income brackets:</p>
<ul>
<li><p>1 to 6 = 0 to 1200 euros</p></li>
<li><p>7 = 1200 to 2400 euros</p></li>
<li><p>8 = 2400 to 3000 euros</p></li>
<li><p>9 = 3000 to 4500 euros</p></li>
<li><p>10 = 4500 to 6000 euros</p></li>
<li><p>11 = 6000 euros and more</p></li>
</ul>
</section>
<section id="univariate-descriptive-analysis" class="level1">
<h1>Univariate Descriptive Analysis</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>data.df<span class="ot">&lt;-</span><span class="fu">data.frame</span>(happiness[<span class="dv">1</span><span class="sc">:</span><span class="dv">2487</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>]) <span class="co">#data frame(rectangular data structures)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="bar-charts-for-happiness-and-income" class="level3">
<h3 class="anchored" data-anchor-id="bar-charts-for-happiness-and-income">Bar Charts for Happiness and Income</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>bxp_o<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data.df,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>happiness)) <span class="sc">+</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"Orange"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>dp_o<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data.df,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Income)) <span class="sc">+</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>              <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(bxp_o, dp_o,</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: The data are displayed in two separate groups of barcharts, so the overall distribution is not clearly visible. We can only observe that, for both the happiness and income variables, most values are as expected, although some high outliers (98 and 99) are present.</p>
</section>
<section id="tables-for-happiness-and-income" class="level3">
<h3 class="anchored" data-anchor-id="tables-for-happiness-and-income">Tables for Happiness and Income</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data.df<span class="sc">$</span>happiness)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1   2   3   4   5   6   7   8   9  10  98  99 
  8   5  11  33  40 189 263 566 736 316 295  11  14 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data.df<span class="sc">$</span>Income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7   8   9  10  11  98  99 
  6   9 105 266 284 355 242 148 106  31  11 258 666 </code></pre>
</div>
</div>
<p>Interpretation: Through the frequency table, we can observe these anomalous values: 11 observations with a value of 98 and 14 with a value of 99 for happiness; and 258 with a value of 98 and 666 with a value of 99 for income. According to the CIS (Centro de Investigaciones Sociológicas), 98 usually indicates “No sabe / Don’t know” and 99 usually indicates “No contesta / No answer.” It is to be expected that for a sensitive question, such as income, people may prefer to abstain from answering.</p>
</section>
<section id="filter-out-outliers" class="level3">
<h3 class="anchored" data-anchor-id="filter-out-outliers">Filter Out Outliers</h3>
<p>Filtering data: For CIS, 98 usually indicates “No sabe / Don’t know” and 99 usually indicates “No contesta / No answer”.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>data<span class="ot">&lt;-</span><span class="fu">filter</span>(data.df,happiness<span class="sc">&lt;</span><span class="dv">11</span> , Income<span class="sc">&lt;</span><span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="describing-socio-economic-characteristics" class="level3">
<h3 class="anchored" data-anchor-id="describing-socio-economic-characteristics">Describing Socio-Economic Characteristics</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>bxp<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>happiness)) <span class="sc">+</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"Orange"</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>dp<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Income)) <span class="sc">+</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(bxp, dp,</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: Now we can see the distributions more clearly. For happiness, the highest density is concentrated in the upper-middle values (5 to 10), although there are some observations with low values. The distribution appears to be left-skewed. For income, we observe a roughly symmetric distribution, with the highest density in the middle values (5 to 7).</p>
</section>
<section id="numerical-measures-for-happiness" class="level3">
<h3 class="anchored" data-anchor-id="numerical-measures-for-happiness">Numerical Measures for Happiness</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>data_df_summary <span class="ot">&lt;-</span>data <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_at</span>(<span class="fu">vars</span>(happiness<span class="sc">:</span>Income), <span class="co"># variables from happiness to income</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">list</span>(<span class="at">avg=</span>mean, <span class="at">std=</span>sd))  <span class="co"># you can include more measures</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>data_df_summary</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  happiness_avg Income_avg happiness_std Income_std
1      7.437137   5.905867      1.719644   1.813259</code></pre>
</div>
</div>
<p>Interpretation: The average happiness is 7.43, indicating that people are moderately happy. The average income is 5.9, which corresponds approximately to 1,200 euros.</p>
</section>
<section id="frequency-table-for-happiness" class="level3">
<h3 class="anchored" data-anchor-id="frequency-table-for-happiness">Frequency Table for Happiness</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>datfreq<span class="ot">&lt;-</span><span class="fu">freq</span>(<span class="fu">ordered</span>(data<span class="sc">$</span>happiness),<span class="at">plot=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>datfreq</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ordered(data$happiness) 
      Frequency  Percent Cum Percent
0             5   0.3224      0.3224
1             2   0.1289      0.4513
2            10   0.6447      1.0961
3            26   1.6763      2.7724
4            26   1.6763      4.4487
5           137   8.8330     13.2818
6           171  11.0251     24.3069
7           350  22.5661     46.8730
8           439  28.3043     75.1773
9           192  12.3791     87.5564
10          193  12.4436    100.0000
Total      1551 100.0000            </code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Income</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>datfreqIncome<span class="ot">&lt;-</span><span class="fu">freq</span>(<span class="fu">ordered</span>(data<span class="sc">$</span>Income),<span class="at">plot=</span>T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-9-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>datfreqIncome</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>ordered(data$Income) 
      Frequency  Percent Cum Percent
1             6   0.3868      0.3868
2             9   0.5803      0.9671
3           103   6.6409      7.6080
4           263  16.9568     24.5648
5           279  17.9884     42.5532
6           354  22.8240     65.3772
7           241  15.5384     80.9155
8           148   9.5422     90.4578
9           106   6.8343     97.2921
10           31   1.9987     99.2908
11           11   0.7092    100.0000
Total      1551 100.0000            </code></pre>
</div>
</div>
<p>The interpretation is the same for the previous bar charts.</p>
</section>
<section id="boxplots-for-happiness-and-income" class="level3">
<h3 class="anchored" data-anchor-id="boxplots-for-happiness-and-income">Boxplots for Happiness and Income</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>bxp<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>happiness))<span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"Orange"</span>) <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>dp<span class="ot">&lt;-</span><span class="fu">ggplot</span>(data,<span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>Income))<span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"lightblue"</span>) <span class="sc">+</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(bxp, dp,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: From the boxplots, we can confirm the negative skew (left-skew) of the happiness variable, as well as the symmetry of income. There are 7 outliers for happiness and 2 for income.</p>
</section>
</section>
<section id="bivariate-descriptive-analysis" class="level1">
<h1>Bivariate Descriptive Analysis</h1>
<section id="contingency-tables---joint-absolute-frequencies" class="level3">
<h3 class="anchored" data-anchor-id="contingency-tables---joint-absolute-frequencies">Contingency Tables - Joint Absolute Frequencies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># group Income</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>dataincome<span class="ot">&lt;-</span><span class="fu">case_when</span>((data<span class="sc">$</span>Income<span class="sc">&lt;=</span><span class="dv">6</span>) <span class="sc">~</span> <span class="st">"0 to 1200"</span>,</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                      (data<span class="sc">$</span>Income<span class="sc">&lt;=</span><span class="dv">7</span>) <span class="sc">~</span> <span class="st">"1200 to 2400"</span>,</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                      (data<span class="sc">$</span>Income<span class="sc">==</span><span class="dv">8</span>) <span class="sc">~</span> <span class="st">"2400 to 3000"</span>,</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>                      (data<span class="sc">$</span>Income<span class="sc">==</span><span class="dv">9</span>) <span class="sc">~</span> <span class="st">"3000 to 4500"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>                      (data<span class="sc">$</span>Income<span class="sc">==</span><span class="dv">10</span>) <span class="sc">~</span> <span class="st">"4500 to 6000"</span>,</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>                      (data<span class="sc">$</span>Income<span class="sc">==</span><span class="dv">11</span>) <span class="sc">~</span> <span class="st">"6000 and more"</span>)</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                      </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>ConTtable<span class="ot">&lt;-</span><span class="fu">table</span>(dataincome,data<span class="sc">$</span>happiness)<span class="co">#Joint absolute frequencies</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>ConTtable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               
dataincome        0   1   2   3   4   5   6   7   8   9  10
  0 to 1200       5   1   9  23  23 114 132 215 252 104 136
  1200 to 2400    0   0   1   3   1  11  19  67  78  34  27
  2400 to 3000    0   1   0   0   1  10  11  34  53  26  12
  3000 to 4500    0   0   0   0   1   2   5  22  43  20  13
  4500 to 6000    0   0   0   0   0   0   4   8   9   7   3
  6000 and more   0   0   0   0   0   0   0   4   4   1   2</code></pre>
</div>
</div>
<p>Interpretation: We can see that most people are concentrated in the upper-right section of the contingency table. This corresponds to individuals who are moderately happy and have low to moderate incomes.</p>
</section>
<section id="contingency-tables---joint-relative-frequencies" class="level3">
<h3 class="anchored" data-anchor-id="contingency-tables---joint-relative-frequencies">Contingency Tables - Joint Relative Frequencies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>RConTtable<span class="ot">&lt;-</span><span class="fu">prop.table</span>(ConTtable)<span class="sc">*</span><span class="dv">100</span> <span class="co">#Joint relative frequencies</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(RConTtable, <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               
dataincome           0      1      2      3      4      5      6      7      8
  0 to 1200      0.322  0.064  0.580  1.483  1.483  7.350  8.511 13.862 16.248
  1200 to 2400   0.000  0.000  0.064  0.193  0.064  0.709  1.225  4.320  5.029
  2400 to 3000   0.000  0.064  0.000  0.000  0.064  0.645  0.709  2.192  3.417
  3000 to 4500   0.000  0.000  0.000  0.000  0.064  0.129  0.322  1.418  2.772
  4500 to 6000   0.000  0.000  0.000  0.000  0.000  0.000  0.258  0.516  0.580
  6000 and more  0.000  0.000  0.000  0.000  0.000  0.000  0.000  0.258  0.258
               
dataincome           9     10
  0 to 1200      6.705  8.769
  1200 to 2400   2.192  1.741
  2400 to 3000   1.676  0.774
  3000 to 4500   1.289  0.838
  4500 to 6000   0.451  0.193
  6000 and more  0.064  0.129</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>RConTtable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               
dataincome                0           1           2           3           4
  0 to 1200      0.32237266  0.06447453  0.58027079  1.48291425  1.48291425
  1200 to 2400   0.00000000  0.00000000  0.06447453  0.19342360  0.06447453
  2400 to 3000   0.00000000  0.06447453  0.00000000  0.00000000  0.06447453
  3000 to 4500   0.00000000  0.00000000  0.00000000  0.00000000  0.06447453
  4500 to 6000   0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
  6000 and more  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
               
dataincome                5           6           7           8           9
  0 to 1200      7.35009671  8.51063830 13.86202450 16.24758221  6.70535139
  1200 to 2400   0.70921986  1.22501612  4.31979368  5.02901354  2.19213411
  2400 to 3000   0.64474533  0.70921986  2.19213411  3.41715023  1.67633785
  3000 to 4500   0.12894907  0.32237266  1.41843972  2.77240490  1.28949065
  4500 to 6000   0.00000000  0.25789813  0.51579626  0.58027079  0.45132173
  6000 and more  0.00000000  0.00000000  0.25789813  0.25789813  0.06447453
               
dataincome               10
  0 to 1200      8.76853643
  1200 to 2400   1.74081238
  2400 to 3000   0.77369439
  3000 to 4500   0.83816892
  4500 to 6000   0.19342360
  6000 and more  0.12894907</code></pre>
</div>
</div>
<p>The interpretation is the same, but using percentages. For example, we can say that 16.24% of the people have an income of 0-1200 euros and a happiness level of 8.</p>
</section>
<section id="contingency-tables---marginal-frequencies" class="level3">
<h3 class="anchored" data-anchor-id="contingency-tables---marginal-frequencies">Contingency Tables - Marginal Frequencies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colSums</span>(RConTtable)<span class="co">#Marginal relative frequencies happiness </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         0          1          2          3          4          5          6 
 0.3223727  0.1289491  0.6447453  1.6763378  1.6763378  8.8330110 11.0251451 
         7          8          9         10 
22.5660864 28.3043198 12.3791103 12.4435848 </code></pre>
</div>
</div>
<p>Interpretation: We observe that most people are moderately to very happy. The mode is 8.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rowSums</span>(RConTtable)<span class="co">#Marginal relative frequencies for Income</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    0 to 1200  1200 to 2400  2400 to 3000  3000 to 4500  4500 to 6000 
   65.3771760    15.5383623     9.5422308     6.8343005     1.9987105 
6000 and more 
    0.7092199 </code></pre>
</div>
</div>
<p>Interpretation: The mode, as well as the majority (65.4%) of people, corresponds to a low income (0 to 1,200 euros).</p>
</section>
<section id="contingency-tables---conditional-frequencies" class="level3">
<h3 class="anchored" data-anchor-id="contingency-tables---conditional-frequencies">Contingency Tables - Conditional Frequencies</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>CConTtableG<span class="ot">&lt;-</span><span class="fu">prop.table</span>(ConTtable,<span class="at">margin=</span><span class="dv">2</span>)<span class="sc">*</span><span class="dv">100</span><span class="co">#Conditional of Income for fixed happiness</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>CConTtableG</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               
dataincome                0           1           2           3           4
  0 to 1200     100.0000000  50.0000000  90.0000000  88.4615385  88.4615385
  1200 to 2400    0.0000000   0.0000000  10.0000000  11.5384615   3.8461538
  2400 to 3000    0.0000000  50.0000000   0.0000000   0.0000000   3.8461538
  3000 to 4500    0.0000000   0.0000000   0.0000000   0.0000000   3.8461538
  4500 to 6000    0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
  6000 and more   0.0000000   0.0000000   0.0000000   0.0000000   0.0000000
               
dataincome                5           6           7           8           9
  0 to 1200      83.2116788  77.1929825  61.4285714  57.4031891  54.1666667
  1200 to 2400    8.0291971  11.1111111  19.1428571  17.7676538  17.7083333
  2400 to 3000    7.2992701   6.4327485   9.7142857  12.0728929  13.5416667
  3000 to 4500    1.4598540   2.9239766   6.2857143   9.7949886  10.4166667
  4500 to 6000    0.0000000   2.3391813   2.2857143   2.0501139   3.6458333
  6000 and more   0.0000000   0.0000000   1.1428571   0.9111617   0.5208333
               
dataincome               10
  0 to 1200      70.4663212
  1200 to 2400   13.9896373
  2400 to 3000    6.2176166
  3000 to 4500    6.7357513
  4500 to 6000    1.5544041
  6000 and more   1.0362694</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>CConTtableM<span class="ot">&lt;-</span><span class="fu">prop.table</span>(ConTtable,<span class="at">margin=</span><span class="dv">1</span>)<span class="sc">*</span><span class="dv">100</span><span class="co">#Conditional of happiness for fixed Income</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>CConTtableM</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>               
dataincome                0           1           2           3           4
  0 to 1200      0.49309665  0.09861933  0.88757396  2.26824458  2.26824458
  1200 to 2400   0.00000000  0.00000000  0.41493776  1.24481328  0.41493776
  2400 to 3000   0.00000000  0.67567568  0.00000000  0.00000000  0.67567568
  3000 to 4500   0.00000000  0.00000000  0.00000000  0.00000000  0.94339623
  4500 to 6000   0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
  6000 and more  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
               
dataincome                5           6           7           8           9
  0 to 1200     11.24260355 13.01775148 21.20315582 24.85207101 10.25641026
  1200 to 2400   4.56431535  7.88381743 27.80082988 32.36514523 14.10788382
  2400 to 3000   6.75675676  7.43243243 22.97297297 35.81081081 17.56756757
  3000 to 4500   1.88679245  4.71698113 20.75471698 40.56603774 18.86792453
  4500 to 6000   0.00000000 12.90322581 25.80645161 29.03225806 22.58064516
  6000 and more  0.00000000  0.00000000 36.36363636 36.36363636  9.09090909
               
dataincome               10
  0 to 1200     13.41222880
  1200 to 2400  11.20331950
  2400 to 3000   8.10810811
  3000 to 4500  12.26415094
  4500 to 6000   9.67741935
  6000 and more 18.18181818</code></pre>
</div>
</div>
<p>Interpretation: In particular, from the second table (happiness | income), we observe that as income increases, the occurrence of low happiness values drops to zero: money contributes to happiness. However, there are also people who are very happy without much money.</p>
</section>
<section id="box-plot-for-conditional-distribution-of-happiness-fixed-income" class="level3">
<h3 class="anchored" data-anchor-id="box-plot-for-conditional-distribution-of-happiness-fixed-income">Box plot for Conditional Distribution of Happiness (Fixed Income)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dataincome<span class="ot">&lt;-</span><span class="fu">as.character</span>(dataincome)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>group<span class="ot">&lt;-</span><span class="fu">tibble</span>(<span class="at">happiness =</span> data<span class="sc">$</span>happiness, <span class="at">income =</span> dataincome) <span class="co"># Creates a dataframe</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(group, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> income, <span class="at">y =</span> happiness)) <span class="sc">+</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">fill=</span><span class="st">"Red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Interpretation: From the boxplots, we observe that the medians are similar, but the lowest happiness values tend to disappear as income increases. Happiness becomes increasingly concentrated (less dispersed) at higher values as income rises.</p>
</section>
<section id="conditional-mean-median-and-sd-for-happiness-fixed-income" class="level3">
<h3 class="anchored" data-anchor-id="conditional-mean-median-and-sd-for-happiness-fixed-income">Conditional mean, median and sd for happiness, fixed income</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>datagrouped <span class="ot">&lt;-</span> <span class="fu">group_by</span>(group, income) <span class="co"># It facilitates operations such as summarise().</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datagrouped) <span class="co"># show first 6 rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
# Groups:   income [3]
  happiness income      
      &lt;int&gt; &lt;chr&gt;       
1         8 0 to 1200   
2         8 2400 to 3000
3         9 2400 to 3000
4         9 1200 to 2400
5        10 2400 to 3000
6         8 1200 to 2400</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data_df_summary <span class="ot">&lt;-</span>datagrouped <span class="sc">%&gt;%</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize_at</span>(<span class="fu">vars</span>(happiness),</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>               <span class="fu">list</span>(<span class="at">avg=</span>mean, <span class="at">stde=</span>sd, <span class="at">median=</span>median))</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>data_df_summary </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
  income          avg  stde median
  &lt;chr&gt;         &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 0 to 1200      7.26  1.86      7
2 1200 to 2400   7.69  1.43      8
3 2400 to 3000   7.68  1.41      8
4 3000 to 4500   8.04  1.19      8
5 4500 to 6000   7.90  1.19      8
6 6000 and more  8.09  1.14      8</code></pre>
</div>
</div>
<p>Interpretation: We can observe that happiness tends to increase with income, although not by much. More importantly, the variability decreases, as we have seen in previous analyses.</p>
</section>
</section>
<section id="confidence-intervals" class="level1">
<h1>Confidence Intervals</h1>
<section id="function" class="level4">
<h4 class="anchored" data-anchor-id="function">[FUNCTION]</h4>
<p>Confidence interval for the population mean (unknown variance)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>CI_m <span class="ot">&lt;-</span> <span class="cf">function</span> (x, <span class="at">ci =</span> <span class="fl">0.95</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span> <span class="ot">&lt;-</span> magrittr<span class="sc">::</span><span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  standard_deviation <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  Margin_Error <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qt</span>((<span class="dv">1</span><span class="sc">-</span>ci)<span class="sc">/</span><span class="dv">2</span>,<span class="at">df=</span>sample_size<span class="dv">-1</span>))<span class="sc">*</span> standard_deviation<span class="sc">/</span><span class="fu">sqrt</span>(sample_size)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">sample_size=</span><span class="fu">length</span>(x), <span class="at">Mean=</span><span class="fu">mean</span>(x), <span class="at">sd=</span><span class="fu">sd</span>(x),</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Margin_Error=</span>Margin_Error,</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'CI lower limit'</span><span class="ot">=</span>(<span class="fu">mean</span>(x) <span class="sc">-</span> Margin_Error),</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'CI Upper limit'</span><span class="ot">=</span>(<span class="fu">mean</span>(x) <span class="sc">+</span> Margin_Error)) <span class="sc">%&gt;%</span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"Measurements"</span>, <span class="at">values_to =</span><span class="st">"values"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span> )</span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_out)</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example" class="level4">
<h4 class="anchored" data-anchor-id="example">Example</h4>
<p>Compute 95% confidence interval for the mean of ‘happiness’ in the population</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CI_m</span>(data<span class="sc">$</span>happiness, <span class="at">ci=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  Measurements      values
  &lt;chr&gt;              &lt;dbl&gt;
1 sample_size    1551     
2 Mean              7.44  
3 sd                1.72  
4 Margin_Error      0.0856
5 CI.lower.limit    7.35  
6 CI.Upper.limit    7.52  </code></pre>
</div>
</div>
<p>If we construct 100 confidence intervals, the population mean will fall within approximately 95 of them. We are 95% confident that the population mean lies within the confidence interval (7.35 , 7.52).</p>
</section>
<section id="function-1" class="level4">
<h4 class="anchored" data-anchor-id="function-1">[FUNCTION]</h4>
<p>Confidence interval for the population proportion in a Bernoulli distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>CI_p <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">ci =</span> <span class="dv">95</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span> <span class="ot">&lt;-</span> magrittr<span class="sc">::</span><span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  vcat<span class="ot">&lt;-</span><span class="fu">na.omit</span>(x)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  p<span class="ot">&lt;-</span><span class="fu">mean</span>(x)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  standard_deviation <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p))</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  sample_size <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  Margin_Error <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">qnorm</span>((<span class="dv">1</span><span class="sc">-</span>ci)<span class="sc">/</span><span class="dv">2</span>))<span class="sc">*</span> standard_deviation<span class="sc">/</span><span class="fu">sqrt</span>(sample_size)</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  df_out <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">sample_size=</span><span class="fu">length</span>(x), p,</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Margin_Error=</span>Margin_Error,</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'CI lower limit'</span><span class="ot">=</span>(p <span class="sc">-</span> Margin_Error),</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>                        <span class="st">'CI Upper limit'</span><span class="ot">=</span>(p <span class="sc">+</span> Margin_Error)) <span class="sc">%&gt;%</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">"Measurements"</span>, <span class="at">values_to =</span><span class="st">"values"</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span> )</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_out)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>} </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-1" class="level4">
<h4 class="anchored" data-anchor-id="example-1">Example</h4>
<p>Compute 95% confidence interval for the population proportion of people that give 7 or more to happiness.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>prop <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(data<span class="sc">$</span>happiness<span class="sc">&gt;=</span><span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">0</span>) <span class="co">#Generate the Bernoulli sample with 1(meet the condition) and 0</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">prop.table</span>(<span class="fu">table</span>(prop))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>prop
       0        1 
0.243069 0.756931 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CI_p</span>(prop ,<span class="at">ci=</span><span class="fl">0.95</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 2
  Measurements      values
  &lt;chr&gt;              &lt;dbl&gt;
1 sample_size    1551     
2 p                 0.757 
3 Margin_Error      0.0213
4 CI.lower.limit    0.736 
5 CI.Upper.limit    0.778 </code></pre>
</div>
</div>
<p>If we construct 100 confidence intervals, the population proportion of people that give 7 or more to happiness will fall within approximately~ 95 of them. We are 95% confident that the population proportion of people that give 7 or more to happiness lies within the confidence interval (0.736 , 0.778).</p>
</section>
<section id="plots-of-ci" class="level3">
<h3 class="anchored" data-anchor-id="plots-of-ci">Plots of CI</h3>
<p>Plot 95% confidence intervals for ‘happiness’ divided by categories of income. Function “summarySE” in the library Rmisc allow us to summarise one variable divided in groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">summarySE</span>(group, <span class="at">measurevar=</span><span class="st">"happiness"</span>, <span class="at">groupvars=</span><span class="st">"income"</span>, <span class="at">na.rm=</span>T)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>graf.point <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x=</span>income, <span class="at">y=</span>happiness)) <span class="sc">+</span> </span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>graf.point</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>graf.interval <span class="ot">&lt;-</span> graf.point <span class="sc">+</span> </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>happiness<span class="sc">-</span>ci, <span class="at">ymax=</span>happiness<span class="sc">+</span>ci), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"happiness"</span>) <span class="sc">+</span> </span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"95% Confidence interval for the mean of happiness by income"</span>)</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>graf.interval</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="happiness_quarto_files/figure-html/unnamed-chunk-22-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Why are some intervals wider?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(data<span class="sc">$</span>Income)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  1   2   3   4   5   6   7   8   9  10  11 
  6   9 103 263 279 354 241 148 106  31  11 </code></pre>
</div>
</div>
<p>The width of the confidence intervals depends on the sample size. The smaller the sample size, the wider the intervals.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>